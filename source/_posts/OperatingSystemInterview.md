---
title: 操作系统面试相关
date: 2020-04-15 16:30:22
author: Kevin Feng
tags:
- 操作系统
- 面试
---
本文主要记录了操作系统基础相关面试内容
<!--more-->

## 面试题汇总

### 进程线程
进程(process)与线程(thread)最大的区别是进程拥有自己的地址空间，某进程内的线程对于其他进程不可见，即进程A不能通过传地址的方式直接读写进程B的存储区域。这就是进程资源不共享但是线程共享.
进程是操作系统的基本调度单位可以有多个线程.
线程开销小.

#### 进程
- 操作系统调度基本单位
- 可以拥有多个线程
- 进程有自己的地址空间不能通过传递地址的方式共享值,即资源不共享
- 开销相对大
- 进程与进程通信称为IPC

#### 线程
- 程序控制的基本单位
- 资源共享,通过传地址或者全局变量的方式就可以沟通
- 用户级线程,用户控制,高效不需要进入内核空间但是并发效率不高
- 内核级线程,系统控制,可以将不同线程分配给不同CPU并发效率高

## 上下文切换
Context Switch 是系统将CPU资源从进程分配给其他进程的机制,宏观上讲就并发了,但是围观上一个CPU还是只能在同一时间运行一个进程. 切换的过程计算机需要先保存当前的状态之后再读取要被切换上的状态,执行此进程.

## 系统调用
用户程序向系统内核请求调用服务的方式.比如显示器键盘等资源,或者创建进程调度其他进程等.这个是用户程序与操作系统之间的重要接口

## Semaphore/Mutex
用户程序占用资源时需要给程序加锁,否则其他程序要是也占用了的话就会造成错误,所以需要加锁来锁住资源控制核心区域(critical section)的权限.

### Semaphore
初始化变量的时候可以设置允许多少个资源共同控制,其他的进程/线程会被堵塞

### Mutex
只允许一个进程/线程访问

### 读写锁
一个writer,多个reader.有writer时则没有reader.

## 死锁
有了锁之后就可能会发生死锁
死锁有四个条件
- 只有一个程序在一个时间内占用资源 
- 在等待其他资源时进程会hold 同时已经获得的资源不会释放
- 这个进程无法拿到其他的资源,不能剥夺其他人的资源
- 等待是成环的

### 避免死锁
银行家算法:
如果这个资源请求会导致死锁就拒绝请求.

## 静态链接库和动态链接库的区别
- 静态链接库在编译时添加入程序中,永久占用程序空间
- 动态链接库在运行时添加入程序,如果不用的话可以剔除程序空间.

## 进程间通信

### 管道
特点:
- 单项
- 先进先出
- 无结构
- 固定大小字节流
- 连接了标准输入输出 就是管道符
- 等待读入时进程将阻塞,同样管道满了的时候写进程将阻塞

#### 无名管道
- 半双工
- 具有亲缘关系的进程才能用

#### 命名管道
- 半双工
- 无亲缘关系也可以用,且用后会保留

### 信号量
信号量是计数器,控制多个进程对资源的访问,主要用在锁机制上,主要用在进程间或者线程间的同步手段

### 消息队列
消息的列表,放在内核中并有队列标识符,克服了信息内容少,管道中的无格式字节流以及缓冲区大小受限的问题

### 信号
特殊的通信方式,用于通知接受进程某个事件已经发生

### 共享内存
映射一段能被其他进程访问的内存,共享内存由一个进程创建,但多个进程都可以访问,这是最快的IPC方式

### 套接字
特殊的点在于他可以用于不同机器之间.

## OS五大功能
- 作业管理
- 文件管理
- 存储管理
- 输入输出(IO资源)管理
- 进程及处理机管理

## 进程的状态
- 等待
    等待某个事件的完成
- 就绪
    内存准备好了等待系统把他挪上CPU
- 运行
    正在运行跑着呢
等待-> 就绪 <==> 运行

## 调度类型
- 抢占式
  一旦开始就运行完
- 非抢占式
  进程运行中可以被系统叫暂停

## 调度策略

### 特征
- 响应时间:
  - 用户输入到产生反应的时间
- 周转时间:
  - 任务开始到最终结束的时间

### 调度算法
- FIFO
- RR
- SJF(短作业优先) 也就是贪心,保证最小的平均等待时间
- 优先级调度
  - 分配优先级,每次都是优先级最高的
  - 如果有一个任务的优先级太低了 可能一直无法进行
- RR
  - 分配固定时间
  - 时间片太大太小都不合适
- 多级队列
  - 按照规则建立多级制度
  - 不同的队列有不同的算法
- 多级反馈队列
  - 任务在队列中移动
  - 通用算法

## 内存分配
- 虚拟地址：用户编程时将代码（或数据）分成若干个段，每条代码或每个数据的地址由段名称 + 段内相对地址构成，这样的程序地址称为虚拟地址
- 逻辑地址：虚拟地址中，段内相对地址部分称为逻辑地址
- 物理地址：实际物理内存中所看到的存储地址称为物理地址
- 逻辑地址空间：在实际应用中，将虚拟地址和逻辑地址经常不加区分，通称为逻辑地址。逻辑地址的集合称为逻辑地址空间
- 线性地址空间：CPU地址总线可以访问的所有地址集合称为线性地址空间
- 物理地址空间：实际存在的可访问的物理内存地址集合称为物理地址空间
- MMU(Memery Management Unit内存管理单元)：实现将用户程序的虚拟地址（逻辑地址） → 物理地址映射的CPU中的硬件电路
- 基地址：在进行地址映射时，经常以段或页为单位并以其最小地址（即起始地址）为基值来进行计算
- 偏移量：在以段或页为单位进行地址映射时，相对于基地址的地址值

## 页面置换算法
对不在内存中的页进行调入,进程执行时才调入
- FIFO
    最早用完的最先出去
- OPT
    在知晓未来的情况下,将最后才用到的页淘汰掉,保证缺页数最小
- LRU
    利用过去预测未来,最近时间内最长时间没用的页淘汰,代价稍高
 
## 内存抖动
频繁页面置换导致效率变低,算法的锅

## Belady
对部分页面置换算法而言,页错误率可能会随着分配帧数增加而增加(FIFO)